<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Usage" href="usage.html" /><link rel="prev" title="Installation" href="install.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Benchmarks</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=6b2c8899" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: black;
  --color-brand-content: #024bb0;
  --color-foreground-muted: #808080;
  --color-highlight-on-target: inherit;
  --color-highlighted-background: #ffffcc;
  --color-sidebar-link-text: black;
  --color-sidebar-link-text--top-level: black;
  --color-link: #024bb0;
  --color-link--hover: #024bb0;
  --color-link-underline: transparent;
  --color-link-underline--hover: #024bb0;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #ffffff;
  --color-brand-content: #5192d2;
  --color-highlight-on-target: inherit;
  --color-highlighted-background: #333300;
  --color-sidebar-link-text: #ffffffcc;
  --color-sidebar-link-text--top-level: #ffffffcc;
  --color-link: #5192d2;
  --color-link--hover: #5192d2;
  --color-link-underline: transparent;
  --color-link-underline--hover: #5192d2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #ffffff;
  --color-brand-content: #5192d2;
  --color-highlight-on-target: inherit;
  --color-highlighted-background: #333300;
  --color-sidebar-link-text: #ffffffcc;
  --color-sidebar-link-text--top-level: #ffffffcc;
  --color-link: #5192d2;
  --color-link--hover: #5192d2;
  --color-link-underline: transparent;
  --color-link-underline--hover: #5192d2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">msgspec</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/msgspec-logo-light.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/msgspec-logo-dark.svg" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="why.html">Why msgspec?</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Benchmarks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="supported-types.html">Supported Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="structs.html">Structs</a></li>
<li class="toctree-l1"><a class="reference internal" href="constraints.html">Constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="converters.html">Converters</a></li>
<li class="toctree-l1"><a class="reference internal" href="jsonschema.html">JSON Schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="schema-evolution.html">Schema Evolution</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="extending.html">Extending</a></li>
<li class="toctree-l1"><a class="reference internal" href="inspect.html">Inspecting Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="perf-tips.html">Performance Tips</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Docs</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="examples/index.html">Examples</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="examples/geojson.html">GeoJSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/asyncio-kv.html">Asyncio TCP Key-Value Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/conda-repodata.html">Conda Repodata</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/pyproject-toml.html">Parsing <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/edgedb.html">Usage with EdgeDB</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/benchmarks.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="benchmarks">
<h1>Benchmarks<a class="headerlink" href="#benchmarks" title="Link to this heading">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Benchmarks are <em>hard</em>.</p>
<p>Repeatedly calling the same function in a tight loop will lead to the
instruction cache staying hot and branches being highly predictable. That’s
not representative of real world access patterns. It’s also hard to write a
nonbiased benchmark. I wrote msgspec, naturally whatever benchmark I
publish it’s going to perform well in.</p>
<p>Even so, people like to see benchmarks. I’ve tried to be as nonbiased as I
can be, and the results hopefully indicate a few tradeoffs you make when
you choose different serialization formats. I encourage you to write your
own benchmarks before making these decisions.</p>
<p>In all cases benchmarks were run on my local development machine (a ~2020
x86 Linux laptop) using CPython 3.11.</p>
</div>
<section id="json-serialization-validation">
<h2>JSON Serialization &amp; Validation<a class="headerlink" href="#json-serialization-validation" title="Link to this heading">¶</a></h2>
<p>This benchmark covers the common case when working with <code class="docutils literal notranslate"><span class="pre">msgspec</span></code> or other
validation libraries. It measures two things:</p>
<ul class="simple">
<li><p>Decoding some JSON input, validating it against a schema, and converting it
into user-friendly python objects.</p></li>
<li><p>Encoding these same python objects back into JSON.</p></li>
</ul>
<p>The data we’re working with has the following schema (defined here using
<a class="reference internal" href="api.html#msgspec.Struct" title="msgspec.Struct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">msgspec.Struct</span></code></a> types):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">enum</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">msgspec</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Permissions</span><span class="p">(</span><span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">READ</span> <span class="o">=</span> <span class="s2">&quot;READ&quot;</span>
    <span class="n">WRITE</span> <span class="o">=</span> <span class="s2">&quot;WRITE&quot;</span>
    <span class="n">READ_WRITE</span> <span class="o">=</span> <span class="s2">&quot;READ_WRITE&quot;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">File</span><span class="p">(</span><span class="n">msgspec</span><span class="o">.</span><span class="n">Struct</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;file&quot;</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">created_by</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">created_at</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span>
    <span class="n">updated_by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">updated_at</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">nbytes</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">permissions</span><span class="p">:</span> <span class="n">Permissions</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Directory</span><span class="p">(</span><span class="n">msgspec</span><span class="o">.</span><span class="n">Struct</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;directory&quot;</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">created_by</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">created_at</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span>
    <span class="n">updated_by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">updated_at</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">contents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">File</span> <span class="o">|</span> <span class="n">Directory</span><span class="p">]</span>
</pre></div>
</div>
<p>The libraries we’re comparing are the following:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://jcristharif.com/msgspec/">msgspec</a> (0.18.5)</p></li>
<li><p><a class="reference external" href="https://github.com/Fatal1ty/mashumaro">mashumaro</a> (3.11)</p></li>
<li><p><a class="reference external" href="https://pydantic-docs.helpmanual.io/">pydantic</a> (both 1.10.13 and 2.5.2)</p></li>
<li><p><a class="reference external" href="https://catt.rs/en/latest/">cattrs</a> (23.2.3)</p></li>
</ul>
<p>Each benchmark creates a message containing one or more <code class="docutils literal notranslate"><span class="pre">File</span></code>/<code class="docutils literal notranslate"><span class="pre">Directory</span></code>
instances, then then serializes, deserializes, and validates it in a loop.</p>
<p>The full benchmark source can be found
<a class="reference external" href="https://github.com/jcrist/msgspec/tree/main/benchmarks/bench_validation">here</a>.</p>
<div id="bench-validate" style="width:75%"></div><p>In this benchmark <code class="docutils literal notranslate"><span class="pre">msgspec</span></code> is ~6x faster than <code class="docutils literal notranslate"><span class="pre">mashumaro</span></code>, ~10x faster
than <code class="docutils literal notranslate"><span class="pre">cattrs</span></code>, and ~12x faster than <code class="docutils literal notranslate"><span class="pre">pydantic</span></code> V2, and ~85x faster than
<code class="docutils literal notranslate"><span class="pre">pydantic</span></code> V1.</p>
<p>This plot shows the performance benefit of performing type validation during
message decoding (as done by <code class="docutils literal notranslate"><span class="pre">msgspec</span></code>) rather than as a secondary step with
a third-party library like <a class="reference external" href="https://catt.rs/en/latest/">cattrs</a> or <a class="reference external" href="https://pydantic-docs.helpmanual.io/">pydantic</a> V1. Validating after decoding
is slower for two reasons:</p>
<ul class="simple">
<li><p>It requires traversing over the entire output structure a second time (which
can be slow due to pointer chasing)</p></li>
<li><p>It may require converting some python objects to their desired output types
(e.g. converting a decoded <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a> to a <a class="reference external" href="https://pydantic-docs.helpmanual.io/">pydantic</a> model), resulting in
allocating many temporary python objects.</p></li>
</ul>
<p>In contrast, libraries like <code class="docutils literal notranslate"><span class="pre">msgspec</span></code> that validate during decoding have none
of these issues. Only a single pass over the decoded data is taken, and the
specified output types are created correctly the first time, avoiding the need
for additional unnecessary allocations.</p>
<p>This benefit also shows up in the memory usage for the same benchmark:</p>
<div id="bench-validate-memory" style="width:75%"></div><p>Here we compare the peak increase in memory usage (RSS) after loading the
schemas and data. <code class="docutils literal notranslate"><span class="pre">msgspec</span></code>’s small library size, schema representation, and
in-memory state means it uses a fraction of the memory of other tools.</p>
</section>
<section id="json-serialization">
<span id="json-benchmark"></span><h2>JSON Serialization<a class="headerlink" href="#json-serialization" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">msgspec</span></code> includes its own high performance JSON library, which may be used
by itself as a replacement for the standard library’s <a class="reference external" href="https://docs.python.org/3/library/json.html#json.dumps" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">json.dumps</span></code></a>/<a class="reference external" href="https://docs.python.org/3/library/json.html#json.loads" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">json.loads</span></code></a>
functions. Here we compare msgspec’s JSON implementation against several other
popular Python JSON libraries.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://jcristharif.com/msgspec/">msgspec</a> (0.18.5)</p></li>
<li><p><a class="reference external" href="https://github.com/ijl/orjson">orjson</a> (3.9.10)</p></li>
<li><p><a class="reference external" href="https://github.com/ultrajson/ultrajson">ujson</a> (5.9.0)</p></li>
<li><p><a class="reference external" href="https://github.com/python-rapidjson/python-rapidjson">rapidjson</a> (1.13)</p></li>
<li><p><a class="reference external" href="https://github.com/TkTech/pysimdjson">simdjson</a> (5.0.2)</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/json.html">json</a> (standard library)</p></li>
</ul>
<p>The full benchmark source can be found
<a class="reference external" href="https://github.com/jcrist/msgspec/tree/main/benchmarks/bench_encodings.py">here</a>.</p>
<div id="bench-json" style="width:75%"></div><p>In this case <code class="docutils literal notranslate"><span class="pre">msgspec</span> <span class="pre">structs</span></code> (which measures <code class="docutils literal notranslate"><span class="pre">msgspec</span></code> with
<code class="docutils literal notranslate"><span class="pre">msgspec.Struct</span></code> schemas pre-defined) is the fastest. When used without
schemas, <code class="docutils literal notranslate"><span class="pre">msgspec</span></code> is on-par with <code class="docutils literal notranslate"><span class="pre">orjson</span></code> (the next fastest JSON library).</p>
<p>This shows that <code class="docutils literal notranslate"><span class="pre">msgspec</span></code> is able to decode JSON faster when a schema is
provided. Due to a more efficient in memory representation, JSON decoding AND
schema validation with <code class="docutils literal notranslate"><span class="pre">msgspec</span></code> than just JSON decoding alone.</p>
</section>
<section id="messagepack-serialization">
<span id="msgpack-benchmark"></span><h2>MessagePack Serialization<a class="headerlink" href="#messagepack-serialization" title="Link to this heading">¶</a></h2>
<p>Likewise, <code class="docutils literal notranslate"><span class="pre">msgspec</span></code> includes its own high performance <a class="reference external" href="https://msgpack.org">MessagePack</a> library,
which may be used by itself without requiring usage of any of msgspec’s
validation machinery. Here we compare msgspec’s MessagePack implementation
against several other popular Python MessagePack libraries.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://jcristharif.com/msgspec/">msgspec</a> (0.18.5)</p></li>
<li><p><a class="reference external" href="https://github.com/msgpack/msgpack-python">msgpack</a> (1.0.7)</p></li>
<li><p><a class="reference external" href="https://github.com/aviramha/ormsgpack">ormsgpack</a> (1.4.1)</p></li>
</ul>
<div id="bench-msgpack" style="width:75%"></div><p>As with the JSON benchmark above, <code class="docutils literal notranslate"><span class="pre">msgspec</span></code> with a schema provided (<code class="docutils literal notranslate"><span class="pre">msgspec</span>
<span class="pre">structs</span></code>) is faster than <code class="docutils literal notranslate"><span class="pre">msgspec</span></code> with no schema. In both cases though
<code class="docutils literal notranslate"><span class="pre">msgspec</span></code> is measurably faster than other Python MessagePack libraries like
<code class="docutils literal notranslate"><span class="pre">msgpack</span></code> or <code class="docutils literal notranslate"><span class="pre">ormsgpack</span></code>.</p>
</section>
<section id="json-serialization-large-data">
<h2>JSON Serialization - Large Data<a class="headerlink" href="#json-serialization-large-data" title="Link to this heading">¶</a></h2>
<p>Here we benchmark loading a <a class="reference external" href="https://conda.anaconda.org/conda-forge/noarch/repodata.json">large JSON file</a> (~77 MiB)
containing information on all the <code class="docutils literal notranslate"><span class="pre">noarch</span></code> packages in <a class="reference external" href="https://conda-forge.org/">conda-forge</a>. We
compare the following libraries:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://jcristharif.com/msgspec/">msgspec</a> (0.18.5)</p></li>
<li><p><a class="reference external" href="https://github.com/ijl/orjson">orjson</a> (3.9.10)</p></li>
<li><p><a class="reference external" href="https://github.com/ultrajson/ultrajson">ujson</a> (5.9.0)</p></li>
<li><p><a class="reference external" href="https://github.com/python-rapidjson/python-rapidjson">rapidjson</a> (1.13)</p></li>
<li><p><a class="reference external" href="https://github.com/TkTech/pysimdjson">simdjson</a> (5.0.2)</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/json.html">json</a> (standard library)</p></li>
</ul>
<p>For each library, we measure both the peak increase in memory usage (RSS) and
the time to JSON decode the file.</p>
<p>The full benchmark source can be found <a class="reference external" href="https://github.com/jcrist/msgspec/tree/main/benchmarks/bench_large_json.py">here</a>.</p>
<p><strong>Results (smaller is better):</strong></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>memory (MiB)</p></th>
<th class="head"><p>vs.</p></th>
<th class="head"><p>time (ms)</p></th>
<th class="head"><p>vs.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>msgspec structs</strong></p></td>
<td><p>67.6</p></td>
<td><p>1.0x</p></td>
<td><p>176.8</p></td>
<td><p>1.0x</p></td>
</tr>
<tr class="row-odd"><td><p><strong>msgspec</strong></p></td>
<td><p>218.3</p></td>
<td><p>3.2x</p></td>
<td><p>630.5</p></td>
<td><p>3.6x</p></td>
</tr>
<tr class="row-even"><td><p><strong>json</strong></p></td>
<td><p>295.0</p></td>
<td><p>4.4x</p></td>
<td><p>868.6</p></td>
<td><p>4.9x</p></td>
</tr>
<tr class="row-odd"><td><p><strong>ujson</strong></p></td>
<td><p>349.1</p></td>
<td><p>5.2x</p></td>
<td><p>1087.0</p></td>
<td><p>6.1x</p></td>
</tr>
<tr class="row-even"><td><p><strong>rapidjson</strong></p></td>
<td><p>375.0</p></td>
<td><p>5.6x</p></td>
<td><p>1004.0</p></td>
<td><p>5.7x</p></td>
</tr>
<tr class="row-odd"><td><p><strong>orjson</strong></p></td>
<td><p>406.3</p></td>
<td><p>6.0x</p></td>
<td><p>691.7</p></td>
<td><p>3.9x</p></td>
</tr>
<tr class="row-even"><td><p><strong>simdjson</strong></p></td>
<td><p>603.2</p></td>
<td><p>8.9x</p></td>
<td><p>1053.0</p></td>
<td><p>6.0x</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">msgspec</span></code> decoding into <a class="reference internal" href="structs.html"><span class="doc">Struct</span></a> types uses the least amount of
memory, and is also the fastest to decode. This makes sense; <code class="docutils literal notranslate"><span class="pre">Struct</span></code> types
are cheaper to allocate and more memory efficient than <code class="docutils literal notranslate"><span class="pre">dict</span></code> types, and for
large messages these differences can really add up.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">msgspec</span></code> decoding without a schema is the second best option for both
memory usage and speed. When decoding without a schema, <code class="docutils literal notranslate"><span class="pre">msgspec</span></code> makes the
assumption that the underlying message probably still has some structure;
short dict keys are temporarily cached to be reused later on, rather than
reallocated every time. This means that instead of allocating 10,000 copies
of the string <code class="docutils literal notranslate"><span class="pre">&quot;name&quot;</span></code>, only a single copy is allocated and reused. For
large messages this can lead to significant memory savings. <code class="docutils literal notranslate"><span class="pre">json</span></code> and
<code class="docutils literal notranslate"><span class="pre">orjson</span></code> also use similar optimizations, but not as effectively.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">orjson</span></code> and <code class="docutils literal notranslate"><span class="pre">simdjson</span></code> use 6-9x more memory than <code class="docutils literal notranslate"><span class="pre">msgspec</span></code> in this
benchmark. In addition to the reasons above, both of these decoders require
copying the original message into a temporary buffer. In this case, the extra
copy adds an extra 77 MiB of overhead!</p></li>
</ul>
</section>
<section id="structs">
<span id="struct-benchmark"></span><h2>Structs<a class="headerlink" href="#structs" title="Link to this heading">¶</a></h2>
<p>Here we benchmark common <a class="reference internal" href="api.html#msgspec.Struct" title="msgspec.Struct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">msgspec.Struct</span></code></a> operations, comparing their
performance against other similar libraries. The cases compared are:</p>
<ul class="simple">
<li><p>Standard Python classes</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/dataclasses.html">dataclasses</a></p></li>
<li><p><a class="reference external" href="https://jcristharif.com/msgspec/">msgspec</a> (0.18.5)</p></li>
<li><p><a class="reference external" href="https://www.attrs.org">attrs</a> (23.1.0)</p></li>
<li><p><a class="reference external" href="https://pydantic-docs.helpmanual.io/">pydantic</a> (2.5.2)</p></li>
</ul>
<p>For each library, the following operations are benchmarked:</p>
<ul class="simple">
<li><p>Time to define a new class. Many libraries that abstract away class
boilerplate add overhead when defining classes, slowing import times for
libraries that make use of these classes.</p></li>
<li><p>Time to create an instance of that class.</p></li>
<li><p>Time to compare two instances for equality (<code class="docutils literal notranslate"><span class="pre">==</span></code>/<code class="docutils literal notranslate"><span class="pre">!=</span></code>).</p></li>
<li><p>Time to compare two instances for order (<code class="docutils literal notranslate"><span class="pre">&lt;</span></code>/<code class="docutils literal notranslate"><span class="pre">&gt;</span></code>/<code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>/<code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>)</p></li>
</ul>
<p>The full benchmark source can be found <a class="reference external" href="https://github.com/jcrist/msgspec/tree/main/benchmarks/bench_structs.py">here</a>.</p>
<p><strong>Results (smaller is better):</strong></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>import (μs)</p></th>
<th class="head"><p>create (μs)</p></th>
<th class="head"><p>equality (μs)</p></th>
<th class="head"><p>order (μs)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>msgspec</strong></p></td>
<td><p>12.51</p></td>
<td><p>0.09</p></td>
<td><p>0.02</p></td>
<td><p>0.03</p></td>
</tr>
<tr class="row-odd"><td><p><strong>standard classes</strong></p></td>
<td><p>7.88</p></td>
<td><p>0.35</p></td>
<td><p>0.08</p></td>
<td><p>0.16</p></td>
</tr>
<tr class="row-even"><td><p><strong>attrs</strong></p></td>
<td><p>483.10</p></td>
<td><p>0.37</p></td>
<td><p>0.14</p></td>
<td><p>1.87</p></td>
</tr>
<tr class="row-odd"><td><p><strong>dataclasses</strong></p></td>
<td><p>506.09</p></td>
<td><p>0.36</p></td>
<td><p>0.14</p></td>
<td><p>0.16</p></td>
</tr>
<tr class="row-even"><td><p><strong>pydantic</strong></p></td>
<td><p>673.47</p></td>
<td><p>1.54</p></td>
<td><p>0.60</p></td>
<td><p>N/A</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p>Standard Python classes are the fastest to import (any library can only add
overhead here). Still, <code class="docutils literal notranslate"><span class="pre">msgspec</span></code> isn’t <em>that</em> much slower, especially
compared to other options.</p></li>
<li><p>Structs are optimized to be cheap to create, and that shows for the creation
benchmark. They’re roughly 4x faster than standard
classes/<code class="docutils literal notranslate"><span class="pre">attrs</span></code>/<code class="docutils literal notranslate"><span class="pre">dataclasses</span></code>, and 17x faster than <code class="docutils literal notranslate"><span class="pre">pydantic</span></code>.</p></li>
<li><p>For equality comparison, msgspec Structs are roughly 4x to 30x faster than
the alternatives.</p></li>
<li><p>For order comparison, msgspec Structs are roughly 5x to 60x faster than the
alternatives.</p></li>
</ul>
</section>
<section id="garbage-collection">
<span id="struct-gc-benchmark"></span><h2>Garbage Collection<a class="headerlink" href="#garbage-collection" title="Link to this heading">¶</a></h2>
<p><a class="reference internal" href="api.html#msgspec.Struct" title="msgspec.Struct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">msgspec.Struct</span></code></a> instances implement several optimizations for reducing garbage
collection (GC) pressure and decreasing memory usage. Here we benchmark structs
(with and without <a class="reference internal" href="structs.html#struct-gc"><span class="std std-ref">gc=False</span></a>) against standard Python
classes (with and without <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#slots">__slots__</a>).</p>
<p>For each option we create a large dictionary containing many simple instances
of the benchmarked type, then measure:</p>
<ul class="simple">
<li><p>The amount of time it takes to do a full garbage collection (gc) pass</p></li>
<li><p>The total amount of memory used by this data structure</p></li>
</ul>
<p>The full benchmark source can be found <a class="reference external" href="https://github.com/jcrist/msgspec/tree/main/benchmarks/bench_gc.py">here</a>.</p>
<p><strong>Results (smaller is better):</strong></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>GC time (ms)</p></th>
<th class="head"><p>Memory Used (MiB)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>standard class</strong></p></td>
<td><p>80.46</p></td>
<td><p>211.66</p></td>
</tr>
<tr class="row-odd"><td><p><strong>standard class with __slots__</strong></p></td>
<td><p>80.06</p></td>
<td><p>120.11</p></td>
</tr>
<tr class="row-even"><td><p><strong>msgspec struct</strong></p></td>
<td><p>13.96</p></td>
<td><p>120.11</p></td>
</tr>
<tr class="row-odd"><td><p><strong>msgspec struct with gc=False</strong></p></td>
<td><p>1.07</p></td>
<td><p>104.85</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p>Standard Python classes are the most memory hungry (since all data is stored
in an instance dict). They also result in the largest GC pause, as the GC has
to traverse the entire outer dict, each class instance, and each instance
dict. All that pointer chasing has a cost.</p></li>
<li><p>Standard classes with <code class="docutils literal notranslate"><span class="pre">__slots__</span></code> are less memory hungry, but still results
in an equivalent GC pauses.</p></li>
<li><p><a class="reference internal" href="api.html#msgspec.Struct" title="msgspec.Struct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">msgspec.Struct</span></code></a> instances have the same memory layout as a class with
<code class="docutils literal notranslate"><span class="pre">__slots__</span></code> (and thus have the same memory usage), but due to deferred GC
tracking a full GC pass completes in a fraction of the time.</p></li>
<li><p><a class="reference internal" href="api.html#msgspec.Struct" title="msgspec.Struct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">msgspec.Struct</span></code></a> instances with <code class="docutils literal notranslate"><span class="pre">gc=False</span></code> have the lowest memory usage
(lack of GC reduces memory by 16 bytes per instance). They also have the
lowest GC pause (75x faster than standard classes!) since the entire
composing dict can be skipped during GC traversal.</p></li>
</ul>
</section>
<section id="library-size">
<span id="benchmark-library-size"></span><h2>Library Size<a class="headerlink" href="#library-size" title="Link to this heading">¶</a></h2>
<p>Here we compare the on-disk size of <code class="docutils literal notranslate"><span class="pre">msgspec</span></code> and <code class="docutils literal notranslate"><span class="pre">pydantic</span></code>, its closest
equivalent.</p>
<p>The full benchmark source can be found <a class="reference external" href="https://github.com/jcrist/msgspec/tree/main/benchmarks/bench_library_size.py">here</a>.</p>
<p><strong>Results (smaller is better)</strong></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>version</p></th>
<th class="head"><p>size (MiB)</p></th>
<th class="head"><p>vs. msgspec</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>msgspec</strong></p></td>
<td><p>0.18.4</p></td>
<td><p>0.46</p></td>
<td><p>1.00x</p></td>
</tr>
<tr class="row-odd"><td><p><strong>pydantic</strong></p></td>
<td><p>2.5.2</p></td>
<td><p>6.71</p></td>
<td><p>14.66x</p></td>
</tr>
</tbody>
</table>
</div>
<p>For applications where dependency size matters, <code class="docutils literal notranslate"><span class="pre">msgspec</span></code> is roughly 15x
smaller on disk.</p>
<script src="https://cdn.jsdelivr.net/npm/vega@5.22.1"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@5.5.0"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6.21.0"></script><script type="text/javascript">

function buildPlot(div, rows, title) {
    var i, time_unit, scale, max_time = 0;
    for (i = 0; i < rows.length; i++) {
        var total = rows[i].encode + rows[i].decode;
        if (total > max_time) {
            max_time = total;
        }
    }
    if (max_time < 1e-6) {
        time_unit = "ns";
        scale = 1e9;
    }
    else if (max_time < 1e-3) {
        time_unit = "μs";
        scale = 1e6;
    }
    else {
        time_unit = "ms";
        scale = 1e3;
    }

    var columns = ["encode", "decode", "total"];
    var data = [];
    for (i = 0; i < rows.length; i++) {
        var label = rows[i].label;
        var et = rows[i].encode * scale;
        var dt = rows[i].decode * scale;
        var tt = et + dt;
        data.push({library: label, method: "encode", time: et});
        data.push({library: label, method: "decode", time: dt});
        data.push({library: label, method: "total", time: tt});
    }

    var spec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json",
        "title": title,
        "config": {
            "view": {"stroke": null},
            "legend": {"title": null, "labelFontSize": 12},
            "title": {"fontSize": 14, "offset": 10},
            "axis": {"titleFontSize": 12, "titlePadding": 10}
        },
        "width": "container",
        "data": {"values": data},
        "transform": [
            {
                "calculate": `join([format(datum.time, '.3'), ' ${time_unit}'], '')`,
                "as": "tooltip",
            }
        ],
        "mark": "bar",
        "encoding": {
            "color": {
                "field": "method",
                "type": "nominal",
                "scale": {"scheme": "tableau20"},
                "sort": columns,
            },
            "row": {
                "field": "library",
                "header": {
                    "orient": "left",
                    "labelAngle": 0,
                    "labelAlign": "left",
                    "labelFontSize": 12
                },
                "sort": {"field": "time", "op": "sum", "order": "ascending"},
                "title": null,
                "type": "nominal",
            },
            "tooltip": {"field": "tooltip", "type": "nominal"},
            "x": {
                "axis": {"grid": false, "title": `Time (${time_unit})`},
                "field": "time",
                "type": "quantitative",
            },
            "y": {
                "axis": {"labels": false, "ticks": false, "title": null},
                "field": "method",
                "type": "nominal",
                "sort": columns,
            },
        },
    };
    vegaEmbed(div, spec);
}

function buildMemPlot(div, rows, title) {
    var data = [];
    for (i = 0; i < rows.length; i++) {
        data.push({library: rows[i].label, memory: rows[i].memory});
    }

    var spec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.2.0.json",
        "title": title,
        "config": {
            "view": {"stroke": null},
            "legend": {"title": null, "labelFontSize": 12},
            "title": {"fontSize": 14, "offset": 10},
            "axis": {"titleFontSize": 12, "titlePadding": 10}
        },
        "width": "container",
        "data": {"values": data},
        "transform": [
            {
                "calculate": "join([format(datum.memory, '.3'), ' MiB'], '')",
                "as": "tooltip",
            }
        ],
        "mark": "bar",
        "encoding": {
            "row": {
                "field": "library",
                "header": {
                    "orient": "left",
                    "labelAngle": 0,
                    "labelAlign": "left",
                    "labelFontSize": 12
                },
                "sort": {"field": "memory", "order": "ascending"},
                "title": null,
                "type": "nominal",
            },
            "tooltip": {"field": "tooltip", "type": "nominal"},
            "x": {
                "axis": {"grid": false, "title": "Memory (MiB)"},
                "field": "memory",
                "type": "quantitative",
            },
        },
    };
    vegaEmbed(div, spec);
}

var results_valid = [
    {"label": "msgspec", "encode": 0.00016727479400015, "decode": 0.0004222057979986857, "memory": 0.640625},
    {"label": "mashumaro", "encode": 0.000797896412001137, "decode": 0.0026786830099990765, "memory": 7.1171875},
    {"label": "cattrs", "encode": 0.002065396289999626, "decode": 0.0033923348699954657, "memory": 3.25390625},
    {"label": "pydantic v2", "encode": 0.0034702956599994648, "decode": 0.0038069566000012854, "memory": 16.26171875},
    {"label": "pydantic v1", "encode": 0.01961492505001843, "decode": 0.02528851079996457, "memory": 10.03125},
];
var results_json = [
    {"label": "msgspec structs", "encode": 0.00014051752349996606, "decode": 0.00036725287499939443},
    {"label": "msgspec", "encode": 0.00018274705249996258, "decode": 0.00048175174399875685},
    {"label": "json", "encode": 0.0012280583099982323, "decode": 0.0009195450700008223},
    {"label": "orjson", "encode": 0.00017935967999983403, "decode": 0.0004634268540012272},
    {"label": "ujson", "encode": 0.0006279176680000091, "decode": 0.0008554406740004197},
    {"label": "rapidjson", "encode": 0.000513588076000815, "decode": 0.0011320363100003306},
    {"label": "simdjson", "encode": 0.00123421613499886, "decode": 0.0007710835699999734},
];
var results_msgpack = [
    {"label": "msgspec structs", "encode": 0.00011157811949942698, "decode": 0.000347989668000082},
    {"label": "msgspec", "encode": 0.00012483930500002316, "decode": 0.000487175850001222},
    {"label": "msgpack", "encode": 0.00040346372400017574, "decode": 0.0007988804240012541},
    {"label": "ormsgpack", "encode": 0.00016052370499983226, "decode": 0.0007458347079991654}
];
buildPlot('#bench-validate', results_valid, "Benchmark - JSON Serialization & Validation");
buildMemPlot('#bench-validate-memory', results_valid, "Benchmark - Serialization & Validation");
buildPlot('#bench-json', results_json, "Benchmark - JSON Serialization");
buildPlot('#bench-msgpack', results_msgpack, "Benchmark - MessagePack Serialization");
</script></section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="usage.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Usage</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="install.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Installation</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; Jim Crist-Harif
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/jcrist/msgspec" aria-label="GitHub"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
</svg></a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Benchmarks</a><ul>
<li><a class="reference internal" href="#json-serialization-validation">JSON Serialization &amp; Validation</a></li>
<li><a class="reference internal" href="#json-serialization">JSON Serialization</a></li>
<li><a class="reference internal" href="#messagepack-serialization">MessagePack Serialization</a></li>
<li><a class="reference internal" href="#json-serialization-large-data">JSON Serialization - Large Data</a></li>
<li><a class="reference internal" href="#structs">Structs</a></li>
<li><a class="reference internal" href="#garbage-collection">Garbage Collection</a></li>
<li><a class="reference internal" href="#library-size">Library Size</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=de5a9c30"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    </body>
</html>